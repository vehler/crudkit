{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "crudkit-kanban",
  "type": "registry:block",
  "title": "CRUDKit Kanban Plugin",
  "description": "Kanban board view plugin for CRUDKit that renders data as draggable cards organized in columns. Uses @dnd-kit for smooth drag-and-drop interactions. Supports grouping data by any field (e.g., status, priority, assignee), customizable column definitions, drag-to-update functionality, custom card renderers, responsive layout, and keyboard navigation. Integrates seamlessly with CRUDKit's data provider pattern. Ideal for task management, project tracking, workflow management, and any application needing a visual board interface.",
  "dependencies": [
    "@dnd-kit/core@^6.3.0",
    "@dnd-kit/sortable@^10.0.0",
    "@dnd-kit/utilities@^3.2.0"
  ],
  "registryDependencies": [
    "crudkit",
    "card",
    "badge"
  ],
  "files": [
    {
      "path": "src/components/crudkit/kanban/kanban-board.tsx",
      "content": "'use client'\n\nimport React from 'react'\nimport {\n  DndContext,\n  DragEndEvent,\n  DragOverlay,\n  DragStartEvent,\n  MouseSensor,\n  TouchSensor,\n  useSensor,\n  useSensors,\n  closestCorners,\n  type UniqueIdentifier,\n  useDroppable,\n} from '@dnd-kit/core'\nimport { useCrudContext } from '@/components/crudkit/crud'\nimport { cn } from '@/lib/utils'\nimport { KanbanCard as DefaultKanbanCard, ColumnHeader as DefaultColumnHeader, EmptyColumn as DefaultEmptyColumn } from '.'\nimport type { KanbanBoardProps } from '@/lib/crudkit/types'\n\n// ============================================\n// KANBAN BOARD COMPONENT\n// ============================================\n\nexport function KanbanBoard<T = any>({\n  groupBy,\n  columns,\n  columnLabels,\n  className,\n  components = {},\n}: KanbanBoardProps<T>) {\n  const { schema, state, actions } = useCrudContext<T>()\n  const [activeId, setActiveId] = React.useState<UniqueIdentifier | null>(null)\n\n  // Use custom components or defaults\n  const Card = components.Card ?? DefaultKanbanCard\n  const ColumnHeader = components.ColumnHeader ?? DefaultColumnHeader\n  const EmptyColumn = components.EmptyColumn ?? DefaultEmptyColumn\n\n  // Configure sensors for drag and drop\n  const sensors = useSensors(\n    useSensor(MouseSensor, {\n      activationConstraint: {\n        distance: 8, // 8px movement required to start drag\n      },\n    }),\n    useSensor(TouchSensor, {\n      activationConstraint: {\n        delay: 200,\n        tolerance: 6,\n      },\n    })\n  )\n\n  if (state.mode !== 'list') return null\n\n  // Group data by the specified field\n  const groupedData: Record<string, T[]> = {}\n  columns.forEach((col) => {\n    groupedData[col] = state.data.filter((item: any) => item[groupBy] === col)\n  })\n\n  // Find the currently dragged item\n  const activeItem = activeId\n    ? state.data.find((item: any) => item[schema.idField] === activeId)\n    : null\n\n  const handleDragStart = (event: DragStartEvent) => {\n    setActiveId(event.active.id)\n  }\n\n  const handleDragEnd = async (event: DragEndEvent) => {\n    const { active, over } = event\n\n    if (!over) {\n      setActiveId(null)\n      return\n    }\n\n    const itemId = active.id as string\n    const newStatus = over.id as string\n\n    // Find the item\n    const item = state.data.find((d: any) => d[schema.idField] === itemId)\n\n    if (item && (item as any)[groupBy] !== newStatus) {\n      // Update the item's status\n      try {\n        await actions.save({ ...item, [groupBy]: newStatus })\n        await actions.refresh()\n      } catch (error) {\n        console.error('Failed to update item:', error)\n      }\n    }\n\n    setActiveId(null)\n  }\n\n  const handleDragCancel = () => {\n    setActiveId(null)\n  }\n\n  return (\n    <DndContext\n      sensors={sensors}\n      collisionDetection={closestCorners}\n      onDragStart={handleDragStart}\n      onDragEnd={handleDragEnd}\n      onDragCancel={handleDragCancel}\n    >\n      <div className={cn('flex gap-4 overflow-x-auto p-4', className)}>\n        {columns.map((column) => (\n          <KanbanColumn\n            key={column}\n            id={column}\n            label={columnLabels?.[column] || column}\n            items={groupedData[column] || []}\n            schema={schema}\n            actions={actions}\n            state={state}\n            CardComponent={Card}\n            ColumnHeaderComponent={ColumnHeader}\n            EmptyColumnComponent={EmptyColumn}\n          />\n        ))}\n      </div>\n\n      <DragOverlay>\n        {activeItem ? (\n          <Card\n            item={activeItem}\n            column={String((activeItem as any)[groupBy])}\n            onView={() => actions.setMode('view', (activeItem as any)[schema.idField])}\n            onEdit={() => actions.setMode('edit', (activeItem as any)[schema.idField])}\n            isDragging\n            schema={schema}\n            actions={actions}\n            state={state}\n          />\n        ) : null}\n      </DragOverlay>\n    </DndContext>\n  )\n}\n\n// ============================================\n// KANBAN COLUMN COMPONENT\n// ============================================\n\ninterface KanbanColumnProps<T = any> {\n  id: string\n  label: string\n  items: T[]\n  schema: any\n  actions: any\n  state: any\n  CardComponent: React.ComponentType<any>\n  ColumnHeaderComponent: React.ComponentType<any>\n  EmptyColumnComponent: React.ComponentType<any>\n}\n\nfunction KanbanColumn<T>({\n  id,\n  label,\n  items,\n  schema,\n  actions,\n  state,\n  CardComponent,\n  ColumnHeaderComponent,\n  EmptyColumnComponent,\n}: KanbanColumnProps<T>) {\n  const { setNodeRef, isOver } = useDroppable({\n    id: id,\n  })\n\n  return (\n    <div\n      ref={setNodeRef}\n      className={cn(\n        'flex min-w-[280px] flex-1 flex-col rounded-lg bg-muted/50 p-4 transition-colors',\n        isOver && 'bg-muted'\n      )}\n    >\n      <ColumnHeaderComponent\n        column={id}\n        label={label}\n        count={items.length}\n        schema={schema}\n        actions={actions}\n        state={state}\n      />\n\n      <div className={cn('flex flex-1 flex-col gap-3')}>\n        {items.length === 0 ? (\n          <EmptyColumnComponent\n            column={id}\n            label={label}\n            schema={schema}\n            actions={actions}\n            state={state}\n          />\n        ) : (\n          items.map((item: any) => (\n            <CardComponent\n              key={item[schema.idField]}\n              item={item}\n              column={id}\n              onView={() => actions.setMode('view', item[schema.idField])}\n              onEdit={() => actions.setMode('edit', item[schema.idField])}\n              isDragging={false}\n              schema={schema}\n              actions={actions}\n              state={state}\n            />\n          ))\n        )}\n      </div>\n    </div>\n  )\n}\n",
      "type": "registry:component",
      "target": "@/components/crudkit/kanban/kanban-board.tsx"
    },
    {
      "path": "src/components/crudkit/kanban/kanban-card.tsx",
      "content": "import * as React from 'react'\nimport { useDraggable } from '@dnd-kit/core'\nimport { Card, CardHeader, CardTitle, CardDescription, CardFooter } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { cn } from '@/lib/utils'\nimport type { CardProps } from '@/lib/crudkit/types'\n\n/**\n * Default KanbanCard Component\n *\n * Draggable card displaying item information.\n * Override this to customize card appearance and content.\n *\n * @example\n * ```typescript\n * import { DefaultKanbanCard } from '@/registry/default/crudkit/crudkit-kanban/components/kanban'\n * import { Badge } from '@/components/ui/badge'\n *\n * const PriorityCard: React.FC<CardProps<Task>> = (props) => {\n *   const { item, onView, onEdit, isDragging } = props\n *\n *   return (\n *     <Card className={cn('cursor-move', isDragging && 'opacity-50')}>\n *       <CardHeader>\n *         <div className=\"flex justify-between\">\n *           <CardTitle>{item.title}</CardTitle>\n *           <Badge variant={item.priority === 'high' ? 'destructive' : 'default'}>\n *             {item.priority}\n *           </Badge>\n *         </div>\n *       </CardHeader>\n *       <CardFooter>\n *         <Button size=\"sm\" onClick={onView}>View</Button>\n *         <Button size=\"sm\" onClick={onEdit}>Edit</Button>\n *       </CardFooter>\n *     </Card>\n *   )\n * }\n *\n * <KanbanBoard components={{ Card: PriorityCard }} />\n * ```\n */\nexport const DefaultKanbanCard = React.forwardRef<HTMLDivElement, CardProps>(\n  ({ item, column, onView, onEdit, isDragging, className, schema, actions, state }, ref) => {\n    const { attributes, listeners, setNodeRef, transform, isDragging: isDraggingFromHook } = useDraggable({\n      id: item[schema.idField],\n    })\n\n    const style = transform\n      ? {\n          transform: `translate3d(${transform.x}px, ${transform.y}px, 0)`,\n        }\n      : undefined\n\n    // Default card rendering - find title and description fields\n    const titleField = schema.fields.find(\n      (f: any) => f.name === 'title' || f.name === 'name'\n    )\n    const descriptionField = schema.fields.find(\n      (f: any) => f.name === 'description'\n    )\n\n    return (\n      <Card\n        ref={(node) => {\n          setNodeRef(node)\n          if (typeof ref === 'function') ref(node)\n          else if (ref) ref.current = node\n        }}\n        style={style}\n        {...listeners}\n        {...attributes}\n        className={cn(\n          'cursor-move transition-opacity hover:shadow-md',\n          (isDragging || isDraggingFromHook) && 'opacity-50',\n          className\n        )}\n      >\n        <CardHeader className=\"p-4 pb-3\">\n          <CardTitle className=\"text-base\">\n            {titleField ? item[titleField.name] : item[schema.idField]}\n          </CardTitle>\n          {descriptionField && item[descriptionField.name] && (\n            <CardDescription className=\"text-sm\">\n              {item[descriptionField.name]}\n            </CardDescription>\n          )}\n        </CardHeader>\n\n        <CardFooter className=\"p-4 pt-0 flex gap-2\">\n          <Button\n            onClick={(e) => {\n              e.stopPropagation()\n              onView()\n            }}\n            variant=\"ghost\"\n            size=\"sm\"\n          >\n            View\n          </Button>\n          <Button\n            onClick={(e) => {\n              e.stopPropagation()\n              onEdit()\n            }}\n            variant=\"ghost\"\n            size=\"sm\"\n          >\n            Edit\n          </Button>\n        </CardFooter>\n      </Card>\n    )\n  }\n)\nDefaultKanbanCard.displayName = 'DefaultKanbanCard'\n",
      "type": "registry:component",
      "target": "@/components/crudkit/kanban/kanban-card.tsx"
    },
    {
      "path": "src/components/crudkit/kanban/column-header.tsx",
      "content": "import * as React from 'react'\nimport { Badge } from '@/components/ui/badge'\nimport { cn } from '@/lib/utils'\nimport type { ColumnHeaderProps } from '@/lib/crudkit/types'\n\n/**\n * Default ColumnHeader Component\n *\n * Displays column title and item count.\n * Override this to add filters, actions, or custom styling to column headers.\n *\n * @example\n * ```typescript\n * import { DropdownMenu } from '@/components/ui/dropdown-menu'\n *\n * const CustomColumnHeader: React.FC<ColumnHeaderProps> = ({ label, count, column }) => (\n *   <div className=\"mb-4 flex items-center justify-between\">\n *     <div className=\"flex items-center gap-2\">\n *       <h3 className=\"text-lg font-semibold\">{label}</h3>\n *       <Badge>{count}</Badge>\n *     </div>\n *     <DropdownMenu>\n *       <DropdownMenuTrigger>â‹®</DropdownMenuTrigger>\n *       <DropdownMenuContent>\n *         <DropdownMenuItem>Sort by date</DropdownMenuItem>\n *         <DropdownMenuItem>Sort by priority</DropdownMenuItem>\n *       </DropdownMenuContent>\n *     </DropdownMenu>\n *   </div>\n * )\n *\n * <KanbanBoard components={{ ColumnHeader: CustomColumnHeader }} />\n * ```\n */\nexport const DefaultColumnHeader = React.forwardRef<HTMLDivElement, ColumnHeaderProps>(\n  ({ column, label, count, className, schema, actions, state }, ref) => {\n    return (\n      <div ref={ref} className={cn('mb-4 flex items-center justify-between', className)}>\n        <h3 className=\"text-lg font-semibold\">{label}</h3>\n        <Badge variant=\"secondary\">\n          {count}\n        </Badge>\n      </div>\n    )\n  }\n)\nDefaultColumnHeader.displayName = 'DefaultColumnHeader'\n",
      "type": "registry:component",
      "target": "@/components/crudkit/kanban/column-header.tsx"
    },
    {
      "path": "src/components/crudkit/kanban/empty-column.tsx",
      "content": "import * as React from 'react'\nimport { cn } from '@/lib/utils'\nimport type { EmptyColumnProps } from '@/lib/crudkit/types'\n\n/**\n * Default EmptyColumn Component\n *\n * Shown when a kanban column has no items.\n * Override this to customize the empty state (e.g., add illustrations, CTA buttons).\n *\n * @example\n * ```typescript\n * import { Button } from '@/components/ui/button'\n * import { PlusIcon } from 'lucide-react'\n *\n * const CustomEmptyColumn: React.FC<EmptyColumnProps> = ({ label, column, actions }) => (\n *   <div className=\"flex flex-1 flex-col items-center justify-center rounded-lg border-2 border-dashed p-8 text-center\">\n *     <EmptyIllustration />\n *     <p className=\"text-muted-foreground mb-4\">No items in {label}</p>\n *     <Button size=\"sm\" onClick={() => actions.setMode('create')}>\n *       <PlusIcon className=\"mr-2\" />\n *       Add Item\n *     </Button>\n *   </div>\n * )\n *\n * <KanbanBoard components={{ EmptyColumn: CustomEmptyColumn }} />\n * ```\n */\nexport const DefaultEmptyColumn = React.forwardRef<HTMLDivElement, EmptyColumnProps>(\n  ({ column, label, className, schema, actions, state }, ref) => {\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          'flex flex-1 items-center justify-center rounded-lg border-2 border-dashed p-8 text-center text-muted-foreground',\n          className\n        )}\n      >\n        No items\n      </div>\n    )\n  }\n)\nDefaultEmptyColumn.displayName = 'DefaultEmptyColumn'\n",
      "type": "registry:component",
      "target": "@/components/crudkit/kanban/empty-column.tsx"
    },
    {
      "path": "src/components/crudkit/kanban/index.ts",
      "content": "/**\n * Kanban Components\n *\n * Export all kanban components for easy import and extension.\n *\n * @example\n * ```typescript\n * import { KanbanCard } from '@/components/crudkit/kanban'\n *\n * // Extend card\n * const MyCard: React.FC<CardProps<Task>> = (props) => {\n *   return (\n *     <div className=\"relative\">\n *       <KanbanCard {...props} />\n *       {props.item.isUrgent && <UrgentBadge />}\n *     </div>\n *   )\n * }\n *\n * <KanbanBoard components={{ Card: MyCard }} />\n * ```\n */\n\nexport { DefaultKanbanCard as KanbanCard } from './kanban-card'\nexport { DefaultColumnHeader as ColumnHeader } from './column-header'\nexport { DefaultEmptyColumn as EmptyColumn } from './empty-column'\n",
      "type": "registry:component",
      "target": "@/components/crudkit/kanban/index.ts"
    }
  ]
}