{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "crudkit-kanban",
  "type": "registry:block",
  "title": "CRUDKit Kanban Plugin",
  "description": "Kanban board view plugin for CRUDKit that renders data as draggable cards organized in columns. Uses @dnd-kit for smooth drag-and-drop interactions. Supports grouping data by any field (e.g., status, priority, assignee), customizable column definitions, drag-to-update functionality, custom card renderers, responsive layout, and keyboard navigation. Integrates seamlessly with CRUDKit's data provider pattern. Ideal for task management, project tracking, workflow management, and any application needing a visual board interface.",
  "dependencies": [
    "@dnd-kit/core@^6.3.0",
    "@dnd-kit/sortable@^10.0.0",
    "@dnd-kit/utilities@^3.2.0"
  ],
  "registryDependencies": [
    "crudkit",
    "card",
    "badge"
  ],
  "files": [
    {
      "path": "registry/default/crudkit/crudkit-kanban/components/kanban-board.tsx",
      "content": "'use client'\n\nimport React from 'react'\nimport {\n  DndContext,\n  DragEndEvent,\n  DragOverlay,\n  DragStartEvent,\n  MouseSensor,\n  TouchSensor,\n  useSensor,\n  useSensors,\n  closestCorners,\n  type UniqueIdentifier,\n  useDraggable,\n  useDroppable,\n} from '@dnd-kit/core'\n// Import the Crud context from crudkit\n// Note: Users will need to ensure proper path resolution\nimport { useCrudContext } from '@/components/crudkit/crud-table'\nimport { cn } from '@/lib/utils'\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Button } from '@/components/ui/button'\n\n// ============================================\n// TYPES\n// ============================================\n\nexport interface KanbanBoardProps {\n  /** Field to group items by (e.g., 'status') */\n  groupBy: string\n\n  /** Column values to display (e.g., ['todo', 'in-progress', 'done']) */\n  columns: string[]\n\n  /** Optional display labels for columns */\n  columnLabels?: Record<string, string>\n\n  /** Optional custom card renderer */\n  renderCard?: (item: any) => React.ReactNode\n}\n\n// ============================================\n// KANBAN BOARD COMPONENT\n// ============================================\n\nexport function KanbanBoard({\n  groupBy,\n  columns,\n  columnLabels,\n  renderCard,\n}: KanbanBoardProps) {\n  const { schema, state, actions } = useCrudContext()\n  const [activeId, setActiveId] = React.useState<UniqueIdentifier | null>(null)\n\n  // Configure sensors for drag and drop\n  const sensors = useSensors(\n    useSensor(MouseSensor, {\n      activationConstraint: {\n        distance: 8, // 8px movement required to start drag\n      },\n    }),\n    useSensor(TouchSensor, {\n      activationConstraint: {\n        delay: 200,\n        tolerance: 6,\n      },\n    })\n  )\n\n  if (state.mode !== 'list') return null\n\n  // Group data by the specified field\n  const groupedData: Record<string, any[]> = {}\n  columns.forEach((col) => {\n    groupedData[col] = state.data.filter((item) => item[groupBy] === col)\n  })\n\n  // Find the currently dragged item\n  const activeItem = activeId\n    ? state.data.find((item) => item[schema.idField] === activeId)\n    : null\n\n  const handleDragStart = (event: DragStartEvent) => {\n    setActiveId(event.active.id)\n  }\n\n  const handleDragEnd = async (event: DragEndEvent) => {\n    const { active, over } = event\n\n    if (!over) {\n      setActiveId(null)\n      return\n    }\n\n    const itemId = active.id as string\n    const newStatus = over.id as string\n\n    // Find the item\n    const item = state.data.find((d) => d[schema.idField] === itemId)\n\n    if (item && item[groupBy] !== newStatus) {\n      // Update the item's status\n      try {\n        await actions.save({ ...item, [groupBy]: newStatus })\n        await actions.refresh()\n      } catch (error) {\n        console.error('Failed to update item:', error)\n      }\n    }\n\n    setActiveId(null)\n  }\n\n  const handleDragCancel = () => {\n    setActiveId(null)\n  }\n\n  return (\n    <DndContext\n      sensors={sensors}\n      collisionDetection={closestCorners}\n      onDragStart={handleDragStart}\n      onDragEnd={handleDragEnd}\n      onDragCancel={handleDragCancel}\n    >\n      <div className={cn('flex gap-4 overflow-x-auto p-4')}>\n        {columns.map((column) => (\n          <KanbanColumn\n            key={column}\n            id={column}\n            title={columnLabels?.[column] || column}\n            items={groupedData[column] || []}\n            schema={schema}\n            actions={actions}\n            renderCard={renderCard}\n          />\n        ))}\n      </div>\n\n      <DragOverlay>\n        {activeItem ? (\n          <KanbanCard\n            item={activeItem}\n            schema={schema}\n            actions={actions}\n            isDragging\n            renderCard={renderCard}\n          />\n        ) : null}\n      </DragOverlay>\n    </DndContext>\n  )\n}\n\n// ============================================\n// KANBAN COLUMN COMPONENT\n// ============================================\n\ninterface KanbanColumnProps {\n  id: string\n  title: string\n  items: any[]\n  schema: any\n  actions: any\n  renderCard?: (item: any) => React.ReactNode\n}\n\nfunction KanbanColumn({\n  id,\n  title,\n  items,\n  schema,\n  actions,\n  renderCard,\n}: KanbanColumnProps) {\n  const { setNodeRef, isOver } = useDroppable({\n    id: id,\n  })\n\n  return (\n    <div\n      ref={setNodeRef}\n      className={cn(\n        'flex min-w-[280px] flex-1 flex-col rounded-lg bg-muted/50 p-4 transition-colors',\n        isOver && 'bg-muted'\n      )}\n    >\n      <div className={cn('mb-4 flex items-center justify-between')}>\n        <h3 className={cn('text-lg font-semibold')}>{title}</h3>\n        <Badge variant=\"secondary\">\n          {items.length}\n        </Badge>\n      </div>\n\n      <div className={cn('flex flex-1 flex-col gap-3')}>\n        {items.length === 0 ? (\n          <div\n            className={cn(\n              'flex flex-1 items-center justify-center rounded-lg border-2 border-dashed p-8 text-center text-muted-foreground'\n            )}\n          >\n            No items\n          </div>\n        ) : (\n          items.map((item) => (\n            <KanbanCard\n              key={item[schema.idField]}\n              item={item}\n              schema={schema}\n              actions={actions}\n              renderCard={renderCard}\n            />\n          ))\n        )}\n      </div>\n    </div>\n  )\n}\n\n// ============================================\n// KANBAN CARD COMPONENT\n// ============================================\n\ninterface KanbanCardProps {\n  item: any\n  schema: any\n  actions: any\n  isDragging?: boolean\n  renderCard?: (item: any) => React.ReactNode\n}\n\nfunction KanbanCard({\n  item,\n  schema,\n  actions,\n  isDragging = false,\n  renderCard,\n}: KanbanCardProps) {\n  const { attributes, listeners, setNodeRef, transform, isDragging: isDraggingFromHook } = useDraggable({\n    id: item[schema.idField],\n  })\n\n  const style = transform\n    ? {\n        transform: `translate3d(${transform.x}px, ${transform.y}px, 0)`,\n      }\n    : undefined\n\n  // If custom renderer provided, use it\n  if (renderCard) {\n    return (\n      <Card\n        ref={setNodeRef}\n        style={style}\n        {...listeners}\n        {...attributes}\n        className={cn(\n          'cursor-move transition-opacity hover:shadow-md',\n          (isDragging || isDraggingFromHook) && 'opacity-50'\n        )}\n      >\n        <CardContent className=\"p-4\">\n          {renderCard(item)}\n        </CardContent>\n      </Card>\n    )\n  }\n\n  // Default card rendering\n  const titleField = schema.fields.find(\n    (f: any) => f.name === 'title' || f.name === 'name'\n  )\n  const descriptionField = schema.fields.find(\n    (f: any) => f.name === 'description'\n  )\n\n  return (\n    <Card\n      ref={setNodeRef}\n      style={style}\n      {...listeners}\n      {...attributes}\n      className={cn(\n        'cursor-move transition-opacity hover:shadow-md',\n        (isDragging || isDraggingFromHook) && 'opacity-50'\n      )}\n    >\n      <CardHeader className=\"p-4 pb-3\">\n        <CardTitle className=\"text-base\">\n          {titleField ? item[titleField.name] : item[schema.idField]}\n        </CardTitle>\n        {descriptionField && item[descriptionField.name] && (\n          <CardDescription className=\"text-sm\">\n            {item[descriptionField.name]}\n          </CardDescription>\n        )}\n      </CardHeader>\n\n      <CardFooter className=\"p-4 pt-0 flex gap-2\">\n        <Button\n          onClick={(e) => {\n            e.stopPropagation()\n            actions.setMode('view', item[schema.idField])\n          }}\n          variant=\"ghost\"\n          size=\"sm\"\n        >\n          View\n        </Button>\n        <Button\n          onClick={(e) => {\n            e.stopPropagation()\n            actions.setMode('edit', item[schema.idField])\n          }}\n          variant=\"ghost\"\n          size=\"sm\"\n        >\n          Edit\n        </Button>\n      </CardFooter>\n    </Card>\n  )\n}\n",
      "type": "registry:component",
      "target": "@/components/crudkit/kanban-board.tsx"
    }
  ]
}