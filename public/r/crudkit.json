{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "crudkit",
  "type": "registry:block",
  "title": "CRUDKit",
  "description": "Complete CRUD system with compound components, URL state management, and data provider interface.",
  "dependencies": [
    "nuqs",
    "clsx",
    "tailwind-merge"
  ],
  "registryDependencies": [],
  "files": [
    {
      "path": "registry/default/crudkit/crudkit/crud-table.tsx",
      "content": "'use client'\n\nimport React, { createContext, useContext, useState, useEffect } from 'react'\nimport { clsx } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\nimport { useCrud, type UseCrudReturn } from './use-crud'\nimport type { DataProvider, Schema, Field } from './data-provider'\n\n// ============================================\n// UTILITIES\n// ============================================\n\nfunction cn(...inputs: (string | undefined | null | false)[]) {\n  return twMerge(clsx(inputs))\n}\n\n// ============================================\n// CONTEXT\n// ============================================\n\ninterface CrudContextValue extends UseCrudReturn {\n  schema: Schema\n}\n\nconst CrudContext = createContext<CrudContextValue | null>(null)\n\nfunction useCrudContext() {\n  const context = useContext(CrudContext)\n  if (!context) {\n    throw new Error('Crud compound components must be used within <Crud>')\n  }\n  return context\n}\n\n// ============================================\n// MAIN CRUD COMPONENT\n// ============================================\n\ninterface CrudProps {\n  schema: Schema\n  dataProvider: DataProvider\n  children: React.ReactNode\n}\n\nfunction Crud({ schema, dataProvider, children }: CrudProps) {\n  const crudReturn = useCrud(schema, dataProvider)\n\n  return (\n    <CrudContext.Provider value={{ ...crudReturn, schema }}>\n      <div className={cn('crud-container', 'p-4')}>{children}</div>\n    </CrudContext.Provider>\n  )\n}\n\n// ============================================\n// TOOLBAR COMPONENT\n// ============================================\n\nfunction CrudToolbar() {\n  const { schema, state, actions } = useCrudContext()\n\n  if (state.mode !== 'list') return null\n\n  return (\n    <div\n      className={cn(\n        'crud-toolbar',\n        'mb-4 flex items-center justify-between'\n      )}\n    >\n      <h1 className={cn('text-2xl font-bold')}>{schema.title} Management</h1>\n      <div className={cn('flex gap-2')}>\n        <button\n          onClick={() => actions.setMode('create')}\n          className={cn(\n            'rounded bg-green-600 px-4 py-2 text-white hover:bg-green-700'\n          )}\n        >\n          + Create New\n        </button>\n        <button\n          onClick={() => actions.refresh()}\n          className={cn(\n            'rounded border border-gray-300 px-4 py-2 hover:bg-gray-50'\n          )}\n        >\n          ⟳ Refresh\n        </button>\n      </div>\n    </div>\n  )\n}\n\n// ============================================\n// FILTERS COMPONENT\n// ============================================\n\ninterface CrudFiltersProps {\n  filterFields?: Field[]\n}\n\nfunction CrudFilters({ filterFields }: CrudFiltersProps) {\n  const { schema, state, actions } = useCrudContext()\n\n  if (state.mode !== 'list') return null\n\n  const fields = filterFields || schema.fields.filter((f) => f.filterable)\n\n  if (fields.length === 0) return null\n\n  return (\n    <div className={cn('crud-filters', 'mb-4 rounded bg-gray-50 p-4')}>\n      <h3 className={cn('mb-2 font-semibold')}>Filters</h3>\n      <div className={cn('flex flex-wrap gap-4')}>\n        {fields.map((field) => (\n          <div key={field.name}>\n            <label className={cn('mb-1 block text-sm font-medium')}>\n              {field.label}\n            </label>\n            {field.type === 'select' ? (\n              <select\n                value={state.filters[field.name] || ''}\n                onChange={(e) =>\n                  actions.setFilter(field.name, e.target.value || null)\n                }\n                className={cn('rounded border border-gray-300 px-2 py-1')}\n              >\n                <option value=\"\">All</option>\n                {field.options?.map((option) => (\n                  <option key={option.value} value={option.value}>\n                    {option.label}\n                  </option>\n                ))}\n              </select>\n            ) : (\n              <input\n                type=\"text\"\n                value={state.filters[field.name] || ''}\n                onChange={(e) =>\n                  actions.setFilter(field.name, e.target.value || null)\n                }\n                className={cn('rounded border border-gray-300 px-2 py-1')}\n              />\n            )}\n          </div>\n        ))}\n        <div className={cn('flex items-end')}>\n          <button\n            onClick={() => actions.clearFilters()}\n            className={cn('rounded border border-gray-300 px-3 py-1 text-sm')}\n          >\n            Clear Filters\n          </button>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// ============================================\n// LIST COMPONENT\n// ============================================\n\ninterface CrudListProps {\n  columns?: string[]\n  showActions?: boolean\n}\n\nfunction CrudList({ columns, showActions = true }: CrudListProps) {\n  const { schema, state, actions } = useCrudContext()\n\n  if (state.mode !== 'list') return null\n\n  const displayColumns = columns || schema.fields.map((f) => f.name)\n\n  return (\n    <div className={cn('crud-list')}>\n      {/* Search Bar */}\n      <div className={cn('mb-4')}>\n        <input\n          type=\"text\"\n          placeholder=\"Search...\"\n          value={state.search}\n          onChange={(e) => actions.setSearch(e.target.value)}\n          className={cn(\n            'w-80 rounded border border-gray-300 px-3 py-2'\n          )}\n        />\n        {state.search && (\n          <button\n            onClick={() => actions.setSearch('')}\n            className={cn('ml-2 rounded border px-3 py-2')}\n          >\n            Clear\n          </button>\n        )}\n      </div>\n\n      {/* Bulk Actions */}\n      {state.selectedRows.length > 0 && (\n        <div className={cn('mb-4 rounded bg-gray-100 p-3')}>\n          <span className={cn('mr-4')}>\n            {state.selectedRows.length} items selected\n          </span>\n          <button\n            onClick={() => actions.deleteMany()}\n            className={cn('mr-2 text-red-600 hover:underline')}\n          >\n            Delete Selected\n          </button>\n          <button\n            onClick={() => actions.selectRows([])}\n            className={cn('text-gray-600 hover:underline')}\n          >\n            Clear Selection\n          </button>\n        </div>\n      )}\n\n      {/* Error Display */}\n      {state.error && (\n        <div className={cn('mb-4 rounded bg-red-50 p-3 text-red-700')}>\n          {state.error}\n        </div>\n      )}\n\n      {/* Table */}\n      <table className={cn('w-full border-collapse')}>\n        <thead>\n          <tr className={cn('border-b-2 border-gray-300')}>\n            <th className={cn('p-2 text-left')}>\n              <input\n                type=\"checkbox\"\n                checked={\n                  state.selectedRows.length === state.data.length &&\n                  state.data.length > 0\n                }\n                onChange={(e) => {\n                  if (e.target.checked) {\n                    actions.selectRows(\n                      state.data.map((item) => item[schema.idField])\n                    )\n                  } else {\n                    actions.selectRows([])\n                  }\n                }}\n              />\n            </th>\n            {displayColumns.map((col) => {\n              const field = schema.fields.find((f) => f.name === col)\n              return (\n                <th\n                  key={col}\n                  className={cn(\n                    'p-2 text-left',\n                    field?.sortable !== false && 'cursor-pointer'\n                  )}\n                  onClick={() =>\n                    field?.sortable !== false && actions.setSort(col)\n                  }\n                >\n                  {field?.label || col}\n                  {state.sortField === col && (\n                    <span className={cn('ml-1')}>\n                      {state.sortOrder === 'asc' ? '↑' : '↓'}\n                    </span>\n                  )}\n                </th>\n              )\n            })}\n            {showActions && <th className={cn('p-2')}>Actions</th>}\n          </tr>\n        </thead>\n        <tbody>\n          {state.loading && (\n            <tr>\n              <td\n                colSpan={displayColumns.length + 2}\n                className={cn('p-8 text-center')}\n              >\n                Loading...\n              </td>\n            </tr>\n          )}\n          {!state.loading && state.data.length === 0 && (\n            <tr>\n              <td\n                colSpan={displayColumns.length + 2}\n                className={cn('p-8 text-center text-gray-500')}\n              >\n                No data found\n              </td>\n            </tr>\n          )}\n          {!state.loading &&\n            state.data.map((item) => (\n              <tr key={item[schema.idField]} className={cn('border-b')}>\n                <td className={cn('p-2')}>\n                  <input\n                    type=\"checkbox\"\n                    checked={state.selectedRows.includes(item[schema.idField])}\n                    onChange={(e) => {\n                      if (e.target.checked) {\n                        actions.selectRows([\n                          ...state.selectedRows,\n                          item[schema.idField],\n                        ])\n                      } else {\n                        actions.selectRows(\n                          state.selectedRows.filter(\n                            (id) => id !== item[schema.idField]\n                          )\n                        )\n                      }\n                    }}\n                  />\n                </td>\n                {displayColumns.map((col) => (\n                  <td key={col} className={cn('p-2')}>\n                    {item[col]}\n                  </td>\n                ))}\n                {showActions && (\n                  <td className={cn('p-2')}>\n                    <button\n                      onClick={() =>\n                        actions.setMode('view', item[schema.idField])\n                      }\n                      className={cn('mr-1 text-blue-600 hover:underline')}\n                    >\n                      View\n                    </button>\n                    <button\n                      onClick={() =>\n                        actions.setMode('edit', item[schema.idField])\n                      }\n                      className={cn('mr-1 text-blue-600 hover:underline')}\n                    >\n                      Edit\n                    </button>\n                    <button\n                      onClick={() => actions.delete(item[schema.idField])}\n                      className={cn('text-red-600 hover:underline')}\n                    >\n                      Delete\n                    </button>\n                  </td>\n                )}\n              </tr>\n            ))}\n        </tbody>\n      </table>\n\n      {/* Pagination */}\n      <div\n        className={cn(\n          'mt-4 flex items-center justify-between rounded bg-gray-50 p-4'\n        )}\n      >\n        <div className={cn('flex items-center gap-4')}>\n          <span>\n            Showing {Math.min((state.page - 1) * state.pageSize + 1, state.totalCount)} to{' '}\n            {Math.min(state.page * state.pageSize, state.totalCount)} of{' '}\n            {state.totalCount} items\n          </span>\n          <select\n            value={state.pageSize}\n            onChange={(e) => actions.setPageSize(Number(e.target.value))}\n            className={cn('rounded border px-2 py-1')}\n          >\n            <option value={5}>5 per page</option>\n            <option value={10}>10 per page</option>\n            <option value={25}>25 per page</option>\n            <option value={50}>50 per page</option>\n          </select>\n        </div>\n        <div className={cn('flex items-center gap-1')}>\n          <button\n            onClick={() => actions.setPage(1)}\n            disabled={state.page === 1}\n            className={cn('rounded border px-2 py-1 disabled:opacity-50')}\n          >\n            ⏮\n          </button>\n          <button\n            onClick={() => actions.setPage(state.page - 1)}\n            disabled={state.page === 1}\n            className={cn('rounded border px-3 py-1 disabled:opacity-50')}\n          >\n            ← Previous\n          </button>\n          <button\n            onClick={() => actions.setPage(state.page + 1)}\n            disabled={state.page * state.pageSize >= state.totalCount}\n            className={cn('rounded border px-3 py-1 disabled:opacity-50')}\n          >\n            Next →\n          </button>\n          <button\n            onClick={() =>\n              actions.setPage(Math.ceil(state.totalCount / state.pageSize))\n            }\n            disabled={state.page * state.pageSize >= state.totalCount}\n            className={cn('rounded border px-2 py-1 disabled:opacity-50')}\n          >\n            ⏭\n          </button>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// ============================================\n// FORM COMPONENT\n// ============================================\n\ninterface CrudFormProps {\n  fields?: Field[]\n}\n\nfunction CrudForm({ fields }: CrudFormProps) {\n  const { schema, state, actions } = useCrudContext()\n  const [formData, setFormData] = useState<any>({})\n  const [errors, setErrors] = useState<Record<string, string>>({})\n\n  useEffect(() => {\n    if (state.mode === 'edit' && state.currentItem) {\n      setFormData(state.currentItem)\n    } else if (state.mode === 'create') {\n      setFormData({})\n    }\n  }, [state.mode, state.currentItem])\n\n  if (!['create', 'edit'].includes(state.mode)) return null\n\n  const displayFields =\n    fields ||\n    schema.fields.filter((f) =>\n      state.mode === 'create' ? f.showOnCreate !== false : f.showOnEdit !== false\n    )\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n\n    // Validation\n    const newErrors: Record<string, string> = {}\n    displayFields.forEach((field) => {\n      if (field.required && !formData[field.name]) {\n        newErrors[field.name] = `${field.label} is required`\n      }\n    })\n\n    if (Object.keys(newErrors).length > 0) {\n      setErrors(newErrors)\n      return\n    }\n\n    try {\n      await actions.save(formData)\n      setFormData({})\n      setErrors({})\n    } catch (err) {\n      // Error already handled in useCrud\n    }\n  }\n\n  const handleChange = (field: string, value: any) => {\n    setFormData((prev: any) => ({ ...prev, [field]: value }))\n    setErrors((prev) => ({ ...prev, [field]: '' }))\n  }\n\n  return (\n    <form onSubmit={handleSubmit} className={cn('max-w-2xl')}>\n      <h2 className={cn('mb-4 text-xl font-bold')}>\n        {state.mode === 'create' ? 'Create' : 'Edit'} {schema.title}\n      </h2>\n\n      {state.error && (\n        <div className={cn('mb-4 rounded bg-red-50 p-3 text-red-700')}>\n          {state.error}\n        </div>\n      )}\n\n      {displayFields.map((field) => (\n        <div key={field.name} className={cn('mb-4')}>\n          <label className={cn('mb-1 block font-medium')}>\n            {field.label}\n            {field.required && <span className={cn('text-red-600')}> *</span>}\n          </label>\n\n          {field.type === 'select' ? (\n            <select\n              value={formData[field.name] || ''}\n              onChange={(e) => handleChange(field.name, e.target.value)}\n              className={cn('w-full rounded border border-gray-300 px-3 py-2')}\n            >\n              <option value=\"\">Select {field.label}</option>\n              {field.options?.map((option) => (\n                <option key={option.value} value={option.value}>\n                  {option.label}\n                </option>\n              ))}\n            </select>\n          ) : field.type === 'textarea' ? (\n            <textarea\n              value={formData[field.name] || ''}\n              onChange={(e) => handleChange(field.name, e.target.value)}\n              className={cn('w-full rounded border border-gray-300 px-3 py-2')}\n              rows={4}\n            />\n          ) : (\n            <input\n              type={field.type || 'text'}\n              value={formData[field.name] || ''}\n              onChange={(e) => handleChange(field.name, e.target.value)}\n              className={cn('w-full rounded border border-gray-300 px-3 py-2')}\n            />\n          )}\n\n          {errors[field.name] && (\n            <span className={cn('text-sm text-red-600')}>\n              {errors[field.name]}\n            </span>\n          )}\n        </div>\n      ))}\n\n      <div className={cn('mt-6 flex gap-2')}>\n        <button\n          type=\"submit\"\n          disabled={state.loading}\n          className={cn(\n            'rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 disabled:opacity-50'\n          )}\n        >\n          {state.loading ? 'Saving...' : 'Save'}\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => actions.setMode('list')}\n          className={cn('rounded border px-4 py-2')}\n        >\n          Cancel\n        </button>\n      </div>\n    </form>\n  )\n}\n\n// ============================================\n// VIEW COMPONENT\n// ============================================\n\nfunction CrudView() {\n  const { schema, state, actions } = useCrudContext()\n\n  if (state.mode !== 'view' || !state.currentItem) return null\n\n  return (\n    <div className={cn('max-w-2xl')}>\n      <h2 className={cn('mb-4 text-xl font-bold')}>\n        View {schema.title}\n      </h2>\n\n      {state.loading && <div>Loading...</div>}\n\n      {!state.loading && state.currentItem && (\n        <div>\n          {schema.fields.map((field) => (\n            <div key={field.name} className={cn('mb-3')}>\n              <strong className={cn('font-medium')}>{field.label}:</strong>{' '}\n              {state.currentItem[field.name] || '-'}\n            </div>\n          ))}\n        </div>\n      )}\n\n      <div className={cn('mt-6 flex gap-2')}>\n        <button\n          onClick={() => actions.setMode('edit', state.selectedId)}\n          className={cn('rounded bg-blue-600 px-4 py-2 text-white')}\n        >\n          Edit\n        </button>\n        <button\n          onClick={() => actions.setMode('list')}\n          className={cn('rounded border px-4 py-2')}\n        >\n          Back to List\n        </button>\n      </div>\n    </div>\n  )\n}\n\n// ============================================\n// EXPORTS\n// ============================================\n\nCrud.Toolbar = CrudToolbar\nCrud.Filters = CrudFilters\nCrud.List = CrudList\nCrud.Form = CrudForm\nCrud.View = CrudView\n\nexport { Crud, useCrudContext }\nexport type { CrudProps }\n",
      "type": "registry:component",
      "target": "@/components/crudkit/crud-table.tsx"
    },
    {
      "path": "registry/default/crudkit/crudkit/use-crud.ts",
      "content": "import { useCallback, useEffect, useState } from 'react'\nimport { useQueryStates, parseAsString, parseAsInteger, parseAsJson } from 'nuqs'\nimport type { DataProvider, GetListParams, Schema } from './data-provider'\n\n// ============================================\n// TYPES\n// ============================================\n\ntype Mode = 'list' | 'create' | 'edit' | 'view'\n\ninterface CrudState<T = any> {\n  mode: Mode\n  selectedId: string | null\n  page: number\n  pageSize: number\n  sortField: string | null\n  sortOrder: 'asc' | 'desc'\n  filters: Record<string, string>\n  search: string\n  data: T[]\n  totalCount: number\n  loading: boolean\n  error: string | null\n  selectedRows: string[]\n  currentItem: T | null\n}\n\ninterface CrudActions {\n  setMode: (mode: Mode, id?: string | null) => void\n  setSort: (field: string) => void\n  setPage: (page: number) => void\n  setPageSize: (size: number) => void\n  setFilter: (key: string, value: string | null) => void\n  clearFilters: () => void\n  setSearch: (query: string) => void\n  selectRows: (ids: string[]) => void\n  refresh: () => Promise<void>\n  save: (formData: any) => Promise<void>\n  delete: (id: string) => Promise<void>\n  deleteMany: () => Promise<void>\n}\n\nexport interface UseCrudReturn<T = any> {\n  state: CrudState<T>\n  actions: CrudActions\n}\n\n// ============================================\n// HOOK\n// ============================================\n\n/**\n * useCrud Hook\n *\n * Main state management hook for CRUDKit.\n * Handles URL state persistence, data fetching, and CRUD operations.\n *\n * @param schema - Resource schema definition\n * @param dataProvider - Data provider implementation\n * @returns State and actions for CRUD operations\n *\n * @example\n * ```typescript\n * const { state, actions } = useCrud(userSchema, userDataProvider)\n *\n * // Access state\n * console.log(state.data, state.loading)\n *\n * // Perform actions\n * actions.setMode('create')\n * actions.save(formData)\n * ```\n */\nexport function useCrud<T = any>(\n  schema: Schema,\n  dataProvider: DataProvider<T>\n): UseCrudReturn<T> {\n  // ============================================\n  // URL STATE (via nuqs)\n  // ============================================\n\n  const [urlState, setUrlState] = useQueryStates(\n    {\n      mode: parseAsString.withDefault('list'),\n      id: parseAsString,\n      page: parseAsInteger.withDefault(1),\n      pageSize: parseAsInteger.withDefault(10),\n      sortField: parseAsString,\n      sortOrder: parseAsString.withDefault('asc'),\n      filters: parseAsJson<Record<string, string>>().withDefault({}),\n      search: parseAsString.withDefault(''),\n    },\n    {\n      history: 'replace', // Use replace to avoid cluttering history\n    }\n  )\n\n  // ============================================\n  // LOCAL STATE\n  // ============================================\n\n  const [data, setData] = useState<T[]>([])\n  const [totalCount, setTotalCount] = useState(0)\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [selectedRows, setSelectedRows] = useState<string[]>([])\n  const [currentItem, setCurrentItem] = useState<T | null>(null)\n\n  // ============================================\n  // DATA FETCHING\n  // ============================================\n\n  const fetchList = useCallback(async () => {\n    if (urlState.mode !== 'list') return\n\n    setLoading(true)\n    setError(null)\n\n    try {\n      const params: GetListParams = {\n        pagination: {\n          page: urlState.page,\n          pageSize: urlState.pageSize,\n        },\n        sort: urlState.sortField\n          ? {\n              field: urlState.sortField,\n              order: urlState.sortOrder as 'asc' | 'desc',\n            }\n          : null,\n        filters: urlState.filters,\n        search: urlState.search,\n      }\n\n      const result = await dataProvider.getList(params)\n\n      setData(result.data)\n      setTotalCount(result.total)\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to fetch data')\n    } finally {\n      setLoading(false)\n    }\n  }, [\n    urlState.mode,\n    urlState.page,\n    urlState.pageSize,\n    urlState.sortField,\n    urlState.sortOrder,\n    urlState.filters,\n    urlState.search,\n    dataProvider,\n  ])\n\n  const fetchItem = useCallback(async () => {\n    if (!urlState.id || !['view', 'edit'].includes(urlState.mode)) return\n\n    setLoading(true)\n    setError(null)\n\n    try {\n      const item = await dataProvider.getOne(urlState.id)\n      setCurrentItem(item)\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to fetch item')\n    } finally {\n      setLoading(false)\n    }\n  }, [urlState.id, urlState.mode, dataProvider])\n\n  // ============================================\n  // EFFECTS\n  // ============================================\n\n  useEffect(() => {\n    fetchList()\n  }, [fetchList])\n\n  useEffect(() => {\n    fetchItem()\n  }, [fetchItem])\n\n  // Reset currentItem when entering create mode\n  useEffect(() => {\n    if (urlState.mode === 'create') {\n      setCurrentItem({} as T)\n    }\n  }, [urlState.mode])\n\n  // ============================================\n  // ACTIONS\n  // ============================================\n\n  const actions: CrudActions = {\n    setMode: (newMode: Mode, id: string | null = null) => {\n      setUrlState({ mode: newMode, id })\n    },\n\n    setSort: (field: string) => {\n      if (urlState.sortField === field) {\n        // Toggle order if same field\n        setUrlState({\n          sortOrder: urlState.sortOrder === 'asc' ? 'desc' : 'asc',\n        })\n      } else {\n        // Set new field with asc order\n        setUrlState({\n          sortField: field,\n          sortOrder: 'asc',\n        })\n      }\n    },\n\n    setPage: (newPage: number) => {\n      setUrlState({ page: newPage })\n    },\n\n    setPageSize: (newSize: number) => {\n      setUrlState({ pageSize: newSize, page: 1 }) // Reset to first page\n    },\n\n    setFilter: (key: string, value: string | null) => {\n      setUrlState((prev) => ({\n        filters: {\n          ...prev.filters,\n          [key]: value || undefined, // Remove if null/empty\n        },\n        page: 1, // Reset to first page\n      }))\n    },\n\n    clearFilters: () => {\n      setUrlState({ filters: {}, page: 1 })\n    },\n\n    setSearch: (query: string) => {\n      setUrlState({ search: query, page: 1 })\n    },\n\n    selectRows: (ids: string[]) => {\n      setSelectedRows(ids)\n    },\n\n    refresh: async () => {\n      await fetchList()\n    },\n\n    save: async (formData: any) => {\n      setLoading(true)\n      setError(null)\n\n      try {\n        if (urlState.mode === 'create') {\n          await dataProvider.create(formData)\n        } else if (urlState.mode === 'edit' && urlState.id) {\n          await dataProvider.update(urlState.id, formData)\n        }\n\n        // Return to list and refresh\n        setUrlState({ mode: 'list', id: null })\n        await fetchList()\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to save')\n        throw err // Re-throw to let form handle it\n      } finally {\n        setLoading(false)\n      }\n    },\n\n    delete: async (id: string) => {\n      if (!window.confirm('Are you sure you want to delete this item?')) {\n        return\n      }\n\n      setLoading(true)\n      setError(null)\n\n      try {\n        await dataProvider.delete(id)\n        await fetchList()\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to delete')\n      } finally {\n        setLoading(false)\n      }\n    },\n\n    deleteMany: async () => {\n      if (selectedRows.length === 0) return\n\n      if (\n        !window.confirm(\n          `Are you sure you want to delete ${selectedRows.length} item(s)?`\n        )\n      ) {\n        return\n      }\n\n      setLoading(true)\n      setError(null)\n\n      try {\n        await dataProvider.deleteMany(selectedRows)\n        setSelectedRows([])\n        await fetchList()\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to delete items')\n      } finally {\n        setLoading(false)\n      }\n    },\n  }\n\n  // ============================================\n  // RETURN\n  // ============================================\n\n  const state: CrudState<T> = {\n    mode: urlState.mode as Mode,\n    selectedId: urlState.id,\n    page: urlState.page,\n    pageSize: urlState.pageSize,\n    sortField: urlState.sortField,\n    sortOrder: urlState.sortOrder as 'asc' | 'desc',\n    filters: urlState.filters,\n    search: urlState.search,\n    data,\n    totalCount,\n    loading,\n    error,\n    selectedRows,\n    currentItem,\n  }\n\n  return { state, actions }\n}\n",
      "type": "registry:hook",
      "target": "@/hooks/use-crud.ts"
    },
    {
      "path": "registry/default/crudkit/crudkit/data-provider.ts",
      "content": "/**\n * CRUDKit Data Provider Interface\n *\n * Implement this interface to connect CRUDKit to your data source.\n * Supports REST APIs, GraphQL, local storage, or any custom backend.\n */\n\n// ============================================\n// TYPE DEFINITIONS\n// ============================================\n\n/**\n * Field configuration for a schema\n */\nexport interface Field {\n  /** Field name (must match data property) */\n  name: string\n\n  /** Human-readable label */\n  label: string\n\n  /** Input type (text, email, select, textarea, etc.) */\n  type?: string\n\n  /** Is this field required? */\n  required?: boolean\n\n  /** Can this field be sorted? */\n  sortable?: boolean\n\n  /** Can this field be filtered? */\n  filterable?: boolean\n\n  /** Show on create form? */\n  showOnCreate?: boolean\n\n  /** Show on edit form? */\n  showOnEdit?: boolean\n\n  /** Options for select/radio inputs */\n  options?: Array<{ value: string; label: string }>\n}\n\n/**\n * Schema definition for a resource\n */\nexport interface Schema {\n  /** Resource title (e.g., \"User\", \"Product\") */\n  title: string\n\n  /** Name of the ID field (default: \"id\") */\n  idField: string\n\n  /** Field definitions */\n  fields: Field[]\n}\n\n/**\n * Pagination parameters\n */\nexport interface PaginationParams {\n  /** Current page number (1-indexed) */\n  page: number\n\n  /** Items per page */\n  pageSize: number\n}\n\n/**\n * Sort parameters\n */\nexport interface SortParams {\n  /** Field to sort by */\n  field: string\n\n  /** Sort order */\n  order: 'asc' | 'desc'\n}\n\n/**\n * Filter parameters (field -> value mapping)\n */\nexport type FilterParams = Record<string, any>\n\n/**\n * Parameters for getList operation\n */\nexport interface GetListParams {\n  /** Pagination settings */\n  pagination: PaginationParams\n\n  /** Sort settings (optional) */\n  sort?: SortParams | null\n\n  /** Filter settings (optional) */\n  filters?: FilterParams\n\n  /** Search query (optional) */\n  search?: string\n}\n\n/**\n * Result from getList operation\n */\nexport interface GetListResult<T = any> {\n  /** Array of data items */\n  data: T[]\n\n  /** Total count of items (for pagination) */\n  total: number\n\n  /** Current page number */\n  page: number\n\n  /** Items per page */\n  pageSize: number\n}\n\n// ============================================\n// DATA PROVIDER INTERFACE\n// ============================================\n\n/**\n * Data Provider Interface\n *\n * Implement this interface to connect your data source to CRUDKit.\n *\n * @example\n * ```typescript\n * class MyDataProvider implements DataProvider {\n *   async getList(params: GetListParams) {\n *     const response = await fetch('/api/users?' + new URLSearchParams({\n *       page: String(params.pagination.page),\n *       pageSize: String(params.pagination.pageSize),\n *       // ... other params\n *     }))\n *     return response.json()\n *   }\n *\n *   async getOne(id: string) {\n *     const response = await fetch(`/api/users/${id}`)\n *     return response.json()\n *   }\n *\n *   // ... implement other methods\n * }\n * ```\n */\nexport interface DataProvider<T = any> {\n  /**\n   * Fetch a paginated list of items\n   *\n   * @param params - Pagination, sorting, filtering, and search parameters\n   * @returns Paginated list result\n   */\n  getList(params: GetListParams): Promise<GetListResult<T>>\n\n  /**\n   * Fetch a single item by ID\n   *\n   * @param id - Item identifier\n   * @returns Single item\n   */\n  getOne(id: string): Promise<T>\n\n  /**\n   * Create a new item\n   *\n   * @param data - Item data\n   * @returns Created item\n   */\n  create(data: Partial<T>): Promise<T>\n\n  /**\n   * Update an existing item\n   *\n   * @param id - Item identifier\n   * @param data - Updated fields\n   * @returns Updated item\n   */\n  update(id: string, data: Partial<T>): Promise<T>\n\n  /**\n   * Delete a single item\n   *\n   * @param id - Item identifier\n   */\n  delete(id: string): Promise<void>\n\n  /**\n   * Delete multiple items\n   *\n   * @param ids - Array of item identifiers\n   */\n  deleteMany(ids: string[]): Promise<void>\n}\n\n// ============================================\n// BASE DATA PROVIDER (OPTIONAL)\n// ============================================\n\n/**\n * Base Data Provider Class\n *\n * Optional base class with common utilities.\n * Extend this class to reduce boilerplate.\n *\n * @example\n * ```typescript\n * class RestDataProvider extends BaseDataProvider {\n *   constructor(private baseUrl: string) {\n *     super()\n *   }\n *\n *   async getList(params: GetListParams) {\n *     // Implement using this.baseUrl\n *   }\n *\n *   // ... implement other methods\n * }\n * ```\n */\nexport abstract class BaseDataProvider<T = any> implements DataProvider<T> {\n  abstract getList(params: GetListParams): Promise<GetListResult<T>>\n  abstract getOne(id: string): Promise<T>\n  abstract create(data: Partial<T>): Promise<T>\n  abstract update(id: string, data: Partial<T>): Promise<T>\n  abstract delete(id: string): Promise<void>\n  abstract deleteMany(ids: string[]): Promise<void>\n\n  /**\n   * Helper: Build query string from params\n   */\n  protected buildQueryString(params: GetListParams): string {\n    const queryParams = new URLSearchParams()\n\n    // Pagination\n    queryParams.set('page', String(params.pagination.page))\n    queryParams.set('pageSize', String(params.pagination.pageSize))\n\n    // Sort\n    if (params.sort) {\n      queryParams.set('sortField', params.sort.field)\n      queryParams.set('sortOrder', params.sort.order)\n    }\n\n    // Filters\n    if (params.filters) {\n      Object.entries(params.filters).forEach(([key, value]) => {\n        if (value !== null && value !== undefined && value !== '') {\n          queryParams.set(`filter[${key}]`, String(value))\n        }\n      })\n    }\n\n    // Search\n    if (params.search) {\n      queryParams.set('search', params.search)\n    }\n\n    return queryParams.toString()\n  }\n\n  /**\n   * Helper: Handle API errors\n   */\n  protected async handleResponse<R>(response: Response): Promise<R> {\n    if (!response.ok) {\n      const errorText = await response.text()\n      throw new Error(`API Error: ${response.status} - ${errorText}`)\n    }\n    return response.json()\n  }\n}\n",
      "type": "registry:lib",
      "target": "@/lib/crudkit/data-provider.ts"
    }
  ]
}